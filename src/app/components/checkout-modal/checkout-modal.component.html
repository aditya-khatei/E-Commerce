<div class="modal-overlay" [class.active]="isOpen$ | async" (click)="close()">
    <div class="modal-content checkout-flow" (click)="$event.stopPropagation()">
        <!-- Header -->
        <div class="checkout-header">
            <h2>Secure Checkout</h2>
            <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="(step / 3) * 100"></div>
            </div>
        </div>

        <!-- Step 1: Shipping -->
        <div class="step-container animate-fade-in" *ngIf="step === 1">
            <h3>Shipping Address</h3>
            <div class="form-group">
                <label>Full Name</label>
                <input type="text" [(ngModel)]="shipping.name" placeholder="John Doe">
            </div>
            <div class="form-group">
                <label>Street Address</label>
                <input type="text" [(ngModel)]="shipping.address" placeholder="123 Apple St">
            </div>
            <div class="form-group">
                <label>City</label>
                <input type="text" [(ngModel)]="shipping.city" placeholder="New York">
            </div>
            <div class="modal-footer">
                <button class="outline" (click)="close()">Cancel</button>
                <button (click)="nextStep()">Continue to Payment</button>
            </div>
        </div>

        <!-- Step 2: Payment -->
        <div class="step-container animate-fade-in" *ngIf="step === 2">
            <h3>Payment Details</h3>
            <div class="form-group">
                <label>Card Number</label>
                <input type="text" [(ngModel)]="payment.card" placeholder="0000 0000 0000 0000">
            </div>
            <div style="display: flex; gap: 1rem;">
                <div class="form-group" style="flex: 1;">
                    <label>Expiry Date</label>
                    <input type="text" [(ngModel)]="payment.expiry" placeholder="MM/YY">
                </div>
                <div class="form-group" style="flex: 1;">
                    <label>CVV</label>
                    <input type="text" [(ngModel)]="payment.cvv" placeholder="123">
                </div>
            </div>
            <div class="modal-footer">
                <button class="outline" (click)="prevStep()">Back</button>
                <button (click)="nextStep()">Confirm Order</button>
            </div>
        </div>

        <!-- Step 3: Success -->
        <div class="step-container success-step animate-fade-in" *ngIf="step === 3">
            <div class="confetti">ðŸŽ‰</div>
            <h3>Payment Successful!</h3>
            <p class="subtitle">Your order has been placed and is being processed.</p>
            <button (click)="close()" style="width: 100%; margin-top: 1rem;">Back to Store</button>
        </div>

    </div>
</div>